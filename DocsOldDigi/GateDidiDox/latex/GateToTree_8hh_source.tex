\hypertarget{GateToTree_8hh_source}{}\doxysection{Gate\+To\+Tree.\+hh}
\label{GateToTree_8hh_source}\index{/biomaps/physique/appli/GateOlga/src/source/digits\_hits/include/GateToTree.hh@{/biomaps/physique/appli/GateOlga/src/source/digits\_hits/include/GateToTree.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2 \textcolor{comment}{   Copyright (C): OpenGATE Collaboration}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{This software is distributed under the terms}}
\DoxyCodeLine{5 \textcolor{comment}{of the GNU Lesser General  Public Licence (LGPL)}}
\DoxyCodeLine{6 \textcolor{comment}{See LICENSE.md for further details}}
\DoxyCodeLine{7 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{comment}{//}}
\DoxyCodeLine{11 \textcolor{comment}{// Created by mdupont on 17/05/19.}}
\DoxyCodeLine{12 \textcolor{comment}{//}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#ifndef GATE\_GATETOTREE\_HH}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define GATE\_GATETOTREE\_HH}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include "{}GateVOutputModule.hh"{}}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include "{}GateTreeFileManager.hh"{}}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}G4SystemOfUnits.hh"{}}}
\DoxyCodeLine{20 \textcolor{comment}{//\#include <vector>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keyword}{class }\mbox{\hyperlink{classGateToTreeMessenger}{GateToTreeMessenger}};}
\DoxyCodeLine{24 \textcolor{keyword}{class }\mbox{\hyperlink{classGateCoincidenceDigi}{GateCoincidenceDigi}};}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keyword}{class }\mbox{\hyperlink{classSaveDataParam}{SaveDataParam}}}
\DoxyCodeLine{27 \{}
\DoxyCodeLine{28 \textcolor{keyword}{public}:}
\DoxyCodeLine{29   \mbox{\hyperlink{classSaveDataParam}{SaveDataParam}}();}
\DoxyCodeLine{30 }
\DoxyCodeLine{31   \textcolor{keywordtype}{bool} toSave() \textcolor{keyword}{const};}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{public}:}
\DoxyCodeLine{34   \textcolor{keywordtype}{bool} m\_save;}
\DoxyCodeLine{35 }
\DoxyCodeLine{36   \textcolor{keywordtype}{void} setToSave(\textcolor{keywordtype}{bool} mSave);}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \};}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{keyword}{class }\mbox{\hyperlink{classGateToTree}{GateToTree}} : \textcolor{keyword}{public} \mbox{\hyperlink{classGateVOutputModule}{GateVOutputModule}}}
\DoxyCodeLine{41 \{}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{keyword}{public}:}
\DoxyCodeLine{44   \mbox{\hyperlink{classGateToTree}{GateToTree}}(\textcolor{keyword}{const} G4String \&name, \mbox{\hyperlink{classGateOutputMgr}{GateOutputMgr}} *outputMgr, DigiMode digiMode);}
\DoxyCodeLine{45 }
\DoxyCodeLine{46 }
\DoxyCodeLine{47 }
\DoxyCodeLine{48   \textcolor{keyword}{virtual} \mbox{\hyperlink{classGateToTree}{\string~GateToTree}}();}
\DoxyCodeLine{49 }
\DoxyCodeLine{50   \textcolor{keywordtype}{void} RecordBeginOfAcquisition() \textcolor{keyword}{override};}
\DoxyCodeLine{51   \textcolor{keywordtype}{void} RecordEndOfAcquisition() \textcolor{keyword}{override};}
\DoxyCodeLine{52   \textcolor{keywordtype}{void} RecordBeginOfRun(\textcolor{keyword}{const} G4Run *run) \textcolor{keyword}{override};}
\DoxyCodeLine{53   \textcolor{keywordtype}{void} RecordEndOfRun(\textcolor{keyword}{const} G4Run *run) \textcolor{keyword}{override};}
\DoxyCodeLine{54   \textcolor{keywordtype}{void} RecordBeginOfEvent(\textcolor{keyword}{const} G4Event *event) \textcolor{keyword}{override};}
\DoxyCodeLine{55   \textcolor{keywordtype}{void} RecordEndOfEvent(\textcolor{keyword}{const} G4Event *event) \textcolor{keyword}{override};}
\DoxyCodeLine{56   \textcolor{keywordtype}{void} RecordStepWithVolume(\textcolor{keyword}{const} \mbox{\hyperlink{classGateVVolume}{GateVVolume}} *v, \textcolor{keyword}{const} G4Step *step) \textcolor{keyword}{override};}
\DoxyCodeLine{57   \textcolor{keywordtype}{void} RecordVoxels(\mbox{\hyperlink{classGateVGeometryVoxelStore}{GateVGeometryVoxelStore}} *store) \textcolor{keyword}{override};}
\DoxyCodeLine{58   \textcolor{keywordtype}{void} RegisterNewCoincidenceDigiCollection(\textcolor{keyword}{const} G4String \&\textcolor{keywordtype}{string}, G4bool aBool) \textcolor{keyword}{override};}
\DoxyCodeLine{59   \textcolor{keywordtype}{void} RegisterNewSingleDigiCollection(\textcolor{keyword}{const} G4String \&\textcolor{keywordtype}{string}, G4bool aBool) \textcolor{keyword}{override};}
\DoxyCodeLine{60 }
\DoxyCodeLine{61   \textcolor{keyword}{const} G4String \&GiveNameOfFile() \textcolor{keyword}{override};}
\DoxyCodeLine{62   \textcolor{keywordtype}{void} addFileName(\textcolor{keyword}{const} G4String \&s);}
\DoxyCodeLine{63 }
\DoxyCodeLine{64   \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetOutputIDName(G4int id\_system, \textcolor{keyword}{const} \textcolor{keywordtype}{char} * anOutputIDName, \textcolor{keywordtype}{size\_t} depth);}
\DoxyCodeLine{65   G4bool getHitsEnabled() \textcolor{keyword}{const};}
\DoxyCodeLine{66   \textcolor{keywordtype}{void} setHitsEnabled(G4bool mHitsEnabled);}
\DoxyCodeLine{67   \textcolor{keywordtype}{void} addCollection(\textcolor{keyword}{const} std::string \&str); \textcolor{comment}{//called by messenger}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 }
\DoxyCodeLine{70   G4bool getOpticalDataEnabled() \textcolor{keyword}{const};}
\DoxyCodeLine{71   \textcolor{keywordtype}{void} setOpticalDataEnabled(G4bool mOpticalDataEnabled);}
\DoxyCodeLine{72 }
\DoxyCodeLine{73   std::unordered\_map<std::string, SaveDataParam> \&getHitsParamsToWrite();}
\DoxyCodeLine{74   std::unordered\_map<std::string, SaveDataParam> \&getOpticalParamsToWrite();}
\DoxyCodeLine{75   std::unordered\_map<std::string, SaveDataParam> \&getSinglesParamsToWrite();}
\DoxyCodeLine{76   std::unordered\_map<std::string, SaveDataParam> \&getCoincidencesParamsToWrite();}
\DoxyCodeLine{77 }
\DoxyCodeLine{78 \textcolor{keyword}{private}:}
\DoxyCodeLine{79 }
\DoxyCodeLine{80   \textcolor{keywordtype}{void} retrieve(\mbox{\hyperlink{classGateCoincidenceDigi}{GateCoincidenceDigi}}* aDigi, G4int side, G4int system\_id);}
\DoxyCodeLine{81 }
\DoxyCodeLine{82   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{83   \textcolor{keywordtype}{void} retrieve(T* p, G4int system\_id) \textcolor{comment}{//p == GateCrystalHit, GateSingleDigi, or \&GatePulses}}
\DoxyCodeLine{84   \{}
\DoxyCodeLine{85       UNUSED(system\_id);}
\DoxyCodeLine{86       m\_runID = p-\/>GetRunID();}
\DoxyCodeLine{87       m\_eventID[0] = p-\/>GetEventID();}
\DoxyCodeLine{88       m\_sourceID[0] = p-\/>GetSourceID();}
\DoxyCodeLine{89       m\_sourcePosX[0] = p-\/>GetSourcePosition().x() / mm;}
\DoxyCodeLine{90       m\_sourcePosY[0] = p-\/>GetSourcePosition().y() / mm;}
\DoxyCodeLine{91       m\_sourcePosZ[0] = p-\/>GetSourcePosition().z() / mm;}
\DoxyCodeLine{92 }
\DoxyCodeLine{93       m\_posX[0] = p-\/>GetGlobalPos().x() / mm;}
\DoxyCodeLine{94       m\_posY[0] = p-\/>GetGlobalPos().y() / mm;}
\DoxyCodeLine{95       m\_posZ[0] = p-\/>GetGlobalPos().z() / mm;}
\DoxyCodeLine{96       m\_time[0] = p-\/>GetTime() / s;}
\DoxyCodeLine{97 }
\DoxyCodeLine{98       m\_axialPos = p-\/>GetScannerPos().z() / mm;}
\DoxyCodeLine{99       m\_rotationAngle = p-\/>GetScannerRotAngle() / degree;}
\DoxyCodeLine{100 }
\DoxyCodeLine{101       m\_nPhantomCompton[0] = p-\/>GetNPhantomCompton();}
\DoxyCodeLine{102       m\_nCrystalCompton[0] = p-\/>GetNCrystalCompton();}
\DoxyCodeLine{103       m\_nPhantomRayleigh[0] = p-\/>GetNPhantomRayleigh();}
\DoxyCodeLine{104       m\_nCrystalRayleigh[0] = p-\/>GetNCrystalRayleigh();}
\DoxyCodeLine{105   \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107   \textcolor{keywordtype}{void} RecordOpticalData(\textcolor{keyword}{const} G4Event * event);}
\DoxyCodeLine{108 }
\DoxyCodeLine{109 }
\DoxyCodeLine{110 }
\DoxyCodeLine{111   \mbox{\hyperlink{classGateToTreeMessenger}{GateToTreeMessenger}} *m\_messenger;}
\DoxyCodeLine{112   \mbox{\hyperlink{classGateOutputTreeFileManager}{GateOutputTreeFileManager}} m\_manager\_hits;}
\DoxyCodeLine{113   \mbox{\hyperlink{classGateOutputTreeFileManager}{GateOutputTreeFileManager}} m\_manager\_optical;}
\DoxyCodeLine{114 \textcolor{comment}{//  std::vector<GateOutputTreeFileManager> m\_vmanager\_singles;}}
\DoxyCodeLine{115   std::unordered\_map<std::string, GateOutputTreeFileManager> m\_mmanager\_singles;}
\DoxyCodeLine{116   std::unordered\_map<std::string, G4int> m\_singles\_to\_collectionID;}
\DoxyCodeLine{117 }
\DoxyCodeLine{118   std::unordered\_map<std::string, GateOutputTreeFileManager> m\_mmanager\_coincidences;}
\DoxyCodeLine{119   std::unordered\_map<std::string, G4int> m\_coincidences\_to\_collectionID;}
\DoxyCodeLine{120 }
\DoxyCodeLine{121   std::vector<std::string> m\_listOfFileName;}
\DoxyCodeLine{122   std::vector<std::string> m\_listOfSinglesCollection;}
\DoxyCodeLine{123   std::vector<std::string> m\_listOfCoincidencesCollection;}
\DoxyCodeLine{124   G4bool m\_hits\_enabled;}
\DoxyCodeLine{125   G4String m\_uselessFileName; \textcolor{comment}{//only for GiveNameOfFile which return a reference..}}
\DoxyCodeLine{126 }
\DoxyCodeLine{127   G4bool m\_opticalData\_enabled;}
\DoxyCodeLine{128 }
\DoxyCodeLine{129  \textcolor{keyword}{private}:}
\DoxyCodeLine{130 }
\DoxyCodeLine{131   G4int m\_PDGEncoding;}
\DoxyCodeLine{132   G4int m\_trackID;}
\DoxyCodeLine{133   G4int m\_parentID;}
\DoxyCodeLine{134   G4double m\_trackLocalTime;}
\DoxyCodeLine{135   G4double m\_time[2];}
\DoxyCodeLine{136   G4float m\_edep[2];}
\DoxyCodeLine{137   G4float m\_stepLength;}
\DoxyCodeLine{138   G4float m\_trackLength;}
\DoxyCodeLine{139 }
\DoxyCodeLine{140 }
\DoxyCodeLine{141   G4int m\_runID;}
\DoxyCodeLine{142   G4int m\_eventID[2];}
\DoxyCodeLine{143   G4int m\_sourceID[2];}
\DoxyCodeLine{144   G4int m\_primaryID;}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 }
\DoxyCodeLine{147   G4float m\_localPosX;}
\DoxyCodeLine{148   G4float m\_localPosY;}
\DoxyCodeLine{149   G4float m\_localPosZ;}
\DoxyCodeLine{150 }
\DoxyCodeLine{151   G4float m\_posX[2];}
\DoxyCodeLine{152   G4float m\_posY[2];}
\DoxyCodeLine{153   G4float m\_posZ[2];}
\DoxyCodeLine{154 }
\DoxyCodeLine{155   G4float m\_momDirX;}
\DoxyCodeLine{156   G4float m\_momDirY;}
\DoxyCodeLine{157   G4float m\_momDirZ;}
\DoxyCodeLine{158 }
\DoxyCodeLine{159   G4float m\_axialPos;}
\DoxyCodeLine{160   G4float m\_rotationAngle;}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 }
\DoxyCodeLine{163   std::string m\_processName;}
\DoxyCodeLine{164   std::string m\_comptonVolumeName[2];}
\DoxyCodeLine{165   std::string m\_RayleighVolumeName[2];}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 }
\DoxyCodeLine{168 }
\DoxyCodeLine{169   G4float m\_sourcePosX[2];}
\DoxyCodeLine{170   G4float m\_sourcePosY[2];}
\DoxyCodeLine{171   G4float m\_sourcePosZ[2];}
\DoxyCodeLine{172 }
\DoxyCodeLine{173   G4int m\_nPhantomCompton[2];}
\DoxyCodeLine{174   G4int m\_nCrystalCompton[2];}
\DoxyCodeLine{175   G4int m\_nPhantomRayleigh[2];}
\DoxyCodeLine{176   G4int m\_nCrystalRayleigh[2];}
\DoxyCodeLine{177 }
\DoxyCodeLine{178   G4float m\_sinogramTheta;}
\DoxyCodeLine{179   G4float m\_sinogramS;}
\DoxyCodeLine{180   }
\DoxyCodeLine{181   \textcolor{comment}{//Additional information from ExtendedVSource}}
\DoxyCodeLine{182   G4int m\_sourceType = 0;}
\DoxyCodeLine{183   G4int m\_decayType = 0;}
\DoxyCodeLine{184   G4int m\_gammaType = 0;}
\DoxyCodeLine{185 }
\DoxyCodeLine{186 }
\DoxyCodeLine{187 }
\DoxyCodeLine{188   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keyword}{auto} VOLUMEID\_SIZE = 10;}
\DoxyCodeLine{189 \textcolor{comment}{//  static const auto OUTPUTID\_SIZE = 6;}}
\DoxyCodeLine{190 }
\DoxyCodeLine{191   G4int m\_volumeID[VOLUMEID\_SIZE];}
\DoxyCodeLine{192   G4int m\_systemID;}
\DoxyCodeLine{193   G4int m\_photonID;}
\DoxyCodeLine{194 \textcolor{comment}{//  G4int m\_outpuID[OUTPUTID\_SIZE];}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196   G4int m\_nScintillation, m\_nCrystalOpticalWLS, m\_nPhantomOpticalWLS;}
\DoxyCodeLine{197   G4int m\_NumCrystalWLS, m\_NumPhantomWLS;}
\DoxyCodeLine{198   std::string   m\_NameOfProcessInCrystal;}
\DoxyCodeLine{199   std::string   m\_NameOfProcessInPhantom;}
\DoxyCodeLine{200   G4double m\_CrystalLastHitPos\_X, m\_CrystalLastHitPos\_Y, m\_CrystalLastHitPos\_Z, m\_CrystalLastHitEnergy;}
\DoxyCodeLine{201   G4double m\_PhantomLastHitPos\_X, m\_PhantomLastHitPos\_Y, m\_PhantomLastHitPos\_Z, m\_PhantomLastHitEnergy;}
\DoxyCodeLine{202   G4double m\_PhantomWLSPos\_X, m\_PhantomWLSPos\_Y,m\_PhantomWLSPos\_Z;}
\DoxyCodeLine{203   G4double m\_MomentumDirectionx, m\_MomentumDirectiony, m\_MomentumDirectionz;}
\DoxyCodeLine{204 }
\DoxyCodeLine{205   std::unordered\_map<std::string, SaveDataParam> m\_hitsParams\_to\_write;}
\DoxyCodeLine{206   std::unordered\_map<std::string, SaveDataParam> m\_opticalParams\_to\_write;}
\DoxyCodeLine{207   std::unordered\_map<std::string, SaveDataParam> m\_singlesParams\_to\_write;}
\DoxyCodeLine{208   std::unordered\_map<std::string, SaveDataParam> m\_coincidencesParams\_to\_write;}
\DoxyCodeLine{209 }
\DoxyCodeLine{210 }
\DoxyCodeLine{211 }
\DoxyCodeLine{212 \textcolor{keyword}{public}:}
\DoxyCodeLine{213 }
\DoxyCodeLine{214 }
\DoxyCodeLine{215   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keyword}{auto} MAX\_NB\_SYSTEM = 32;}
\DoxyCodeLine{216   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keyword}{auto} MAX\_DEPTH\_SYSTEM = 6;}
\DoxyCodeLine{217   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keyword}{auto} MAX\_OUTPUTIDNAME\_SIZE = 32;}
\DoxyCodeLine{218 }
\DoxyCodeLine{219   \textcolor{keyword}{static} \textcolor{keywordtype}{char} m\_outputIDName[MAX\_NB\_SYSTEM][MAX\_DEPTH\_SYSTEM][MAX\_OUTPUTIDNAME\_SIZE];}
\DoxyCodeLine{220   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} m\_outputIDHasName[GateToTree::MAX\_NB\_SYSTEM][GateToTree::MAX\_DEPTH\_SYSTEM];}
\DoxyCodeLine{221   \textcolor{keyword}{static} G4int m\_max\_depth\_system[MAX\_NB\_SYSTEM];}
\DoxyCodeLine{222 }
\DoxyCodeLine{223  \textcolor{keyword}{private}:}
\DoxyCodeLine{224   G4int m\_outputID[2][MAX\_NB\_SYSTEM][MAX\_DEPTH\_SYSTEM];}
\DoxyCodeLine{225 }
\DoxyCodeLine{226 }
\DoxyCodeLine{227 }
\DoxyCodeLine{228 }
\DoxyCodeLine{229 }
\DoxyCodeLine{230 }
\DoxyCodeLine{231 \};}
\DoxyCodeLine{232 }
\DoxyCodeLine{233 }
\DoxyCodeLine{234 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//GATE\_GATETOTREE\_HH}}

\end{DoxyCode}
