\hypertarget{GateTotalDiscreteProcess_8hh_source}{}\doxysection{Gate\+Total\+Discrete\+Process.\+hh}
\label{GateTotalDiscreteProcess_8hh_source}\index{/biomaps/physique/appli/GateOlga/src/source/physics/include/GateTotalDiscreteProcess.hh@{/biomaps/physique/appli/GateOlga/src/source/physics/include/GateTotalDiscreteProcess.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2 \textcolor{comment}{   Copyright (C): OpenGATE Collaboration}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{This software is distributed under the terms}}
\DoxyCodeLine{5 \textcolor{comment}{of the GNU Lesser General  Public Licence (LGPL)}}
\DoxyCodeLine{6 \textcolor{comment}{See LICENSE.md for further details}}
\DoxyCodeLine{7 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{8 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#ifndef GateTotalDiscreteProcess\_hh}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define GateTotalDiscreteProcess\_hh}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}G4VDiscreteProcess.hh"{}}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include "{}G4VEmProcess.hh"{}}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}G4ios.hh"{}}}
\DoxyCodeLine{20 \textcolor{keyword}{class }G4VParticleChange;}
\DoxyCodeLine{21 \textcolor{keyword}{class }G4Track;}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}G4ForceCondition.hh"{}}}
\DoxyCodeLine{23 \textcolor{keyword}{class }G4ParticleDefinition;}
\DoxyCodeLine{24 \textcolor{keyword}{class }G4Step;}
\DoxyCodeLine{25 \textcolor{keyword}{class }G4String;}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}G4Gamma.hh"{}}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include "{}G4PhysicsTable.hh"{}}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}GateCrossSectionsTable.hh"{}}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include "{}CLHEP/Random/RandFlat.h"{}} }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include "{}Randomize.hh"{}}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <cassert>}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{keyword}{class }\mbox{\hyperlink{classGateTotalDiscreteProcess}{GateTotalDiscreteProcess}} : \textcolor{keyword}{public} G4VDiscreteProcess}
\DoxyCodeLine{35 \{}
\DoxyCodeLine{36     \textcolor{keyword}{public}:}
\DoxyCodeLine{37         \mbox{\hyperlink{classGateTotalDiscreteProcess}{GateTotalDiscreteProcess}} ( \textcolor{keyword}{const} G4String\& name, G4ProcessType type, G4int num\_processes, \textcolor{keyword}{const} G4ParticleDefinition* particle\_type, G4double minEnergy, G4double maxEnergy, G4int binNumbers );}
\DoxyCodeLine{38         \textcolor{keyword}{virtual} \mbox{\hyperlink{classGateTotalDiscreteProcess}{\string~GateTotalDiscreteProcess}}();}
\DoxyCodeLine{39         \textcolor{keywordtype}{bool} AddDiscreteProcess (G4VDiscreteProcess* p );}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 }
\DoxyCodeLine{42         G4VParticleChange *     PostStepDoIt ( \textcolor{keyword}{const} G4Track \&track, \textcolor{keyword}{const} G4Step \&stepData );}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{keyword}{inline} G4double     PostStepGetPhysicalInteractionLength ( \textcolor{keyword}{const} G4Track \&track, G4double previousStepSize, G4ForceCondition *condition );}
\DoxyCodeLine{46 }
\DoxyCodeLine{47         \textcolor{keywordtype}{void}    BuildPhysicsTable ( \textcolor{keyword}{const} G4ParticleDefinition \& );}
\DoxyCodeLine{48         \textcolor{keyword}{inline} G4double GetNumberOfInteractionLengthLeft() \textcolor{keyword}{const};}
\DoxyCodeLine{49         \textcolor{keyword}{inline} G4bool   IsApplicable ( \textcolor{keyword}{const} G4ParticleDefinition \& );}
\DoxyCodeLine{50         \textcolor{keyword}{const} \mbox{\hyperlink{classGateCrossSectionsTable}{GateCrossSectionsTable}}* GetTotalCrossSectionsTable() \textcolor{keyword}{const};}
\DoxyCodeLine{51         G4VProcess* GetActiveProcess() \textcolor{keyword}{const};}
\DoxyCodeLine{52         G4VProcess* SampleActiveProcess(G4Material*,G4double energy);}
\DoxyCodeLine{53 }
\DoxyCodeLine{54     \textcolor{keyword}{protected}:}
\DoxyCodeLine{55         G4double GetMeanFreePath ( \textcolor{keyword}{const} G4Track \&aTrack, G4double previousStepSize, G4ForceCondition *condition );}
\DoxyCodeLine{56 }
\DoxyCodeLine{57         \textcolor{keywordtype}{void} CreateTotalMaxCrossSectionTable(\textcolor{keyword}{const} std::vector<G4Material*>\&);}
\DoxyCodeLine{58 }
\DoxyCodeLine{59         \textcolor{keywordtype}{void} BuildCrossSectionsTables();}
\DoxyCodeLine{60 }
\DoxyCodeLine{61         G4int m\_nNumProcesses, m\_nMaxNumProcesses;}
\DoxyCodeLine{62         \textcolor{keywordtype}{bool} m\_nInitialized;}
\DoxyCodeLine{63         \textcolor{keyword}{const} G4ParticleDefinition* pParticleType;}
\DoxyCodeLine{64         std::vector<G4VDiscreteProcess*> m\_oProcessVec;}
\DoxyCodeLine{65         std::vector<G4String*> m\_oProcessNameVec;}
\DoxyCodeLine{66         std::vector<GateCrossSectionsTable*> m\_oCrossSectionsTableVec;}
\DoxyCodeLine{67         \mbox{\hyperlink{classGateCrossSectionsTable}{GateCrossSectionsTable}}* m\_pTotalCrossSectionsTable;}
\DoxyCodeLine{68         G4double m\_nTotalMinEnergy, m\_nTotalMaxEnergy;}
\DoxyCodeLine{69         G4int m\_nTotalBinNumber; \textcolor{comment}{// binning information}}
\DoxyCodeLine{70         \textcolor{keywordtype}{size\_t} m\_nProcessWithSmallestPIL;}
\DoxyCodeLine{71 \};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 }
\DoxyCodeLine{74 }
\DoxyCodeLine{75 }
\DoxyCodeLine{76 }
\DoxyCodeLine{77 \textcolor{keyword}{inline} G4bool GateTotalDiscreteProcess::IsApplicable ( \textcolor{keyword}{const} G4ParticleDefinition \&p )}
\DoxyCodeLine{78 \{}
\DoxyCodeLine{79     \textcolor{keywordflow}{return} ( \&p==pParticleType ); \textcolor{comment}{// singleton pointer comparison should be sufficient (faster!)}}
\DoxyCodeLine{80 \}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{keyword}{inline} G4double GateTotalDiscreteProcess::GetNumberOfInteractionLengthLeft ()\textcolor{keyword}{ const}}
\DoxyCodeLine{83 \textcolor{keyword}{}\{}
\DoxyCodeLine{84     \textcolor{keywordflow}{return} theNumberOfInteractionLengthLeft;}
\DoxyCodeLine{85 \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 }
\DoxyCodeLine{88 \textcolor{keyword}{inline} G4double     GateTotalDiscreteProcess::PostStepGetPhysicalInteractionLength ( \textcolor{keyword}{const} G4Track \&track, G4double previousStepSize, G4ForceCondition *condition )}
\DoxyCodeLine{89 \{}
\DoxyCodeLine{90     G4double b=m\_oProcessVec[0]-\/>PostStepGetPhysicalInteractionLength ( track, previousStepSize, condition );}
\DoxyCodeLine{91     m\_nProcessWithSmallestPIL=0;}
\DoxyCodeLine{92     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=1;i<m\_oProcessVec.size();i++)}
\DoxyCodeLine{93     \textcolor{comment}{// shouldn't it be better ??}}
\DoxyCodeLine{94     \textcolor{comment}{// for (std::vector<G4VDiscreteProcess*>::iterator itr=m\_oProcessVec.begin(); itr!= m\_oProcessVec.end(); ++itr)}}
\DoxyCodeLine{95     \{}
\DoxyCodeLine{96         }
\DoxyCodeLine{97         \textcolor{keyword}{const} G4double a=m\_oProcessVec[i]-\/>PostStepGetPhysicalInteractionLength (track, previousStepSize, condition);}
\DoxyCodeLine{98         \textcolor{keywordflow}{if} (a<b)}
\DoxyCodeLine{99         \{}
\DoxyCodeLine{100             b=a;}
\DoxyCodeLine{101             m\_nProcessWithSmallestPIL=i;}
\DoxyCodeLine{102         \}}
\DoxyCodeLine{103     \}}
\DoxyCodeLine{104     \textcolor{keywordflow}{return} b;}
\DoxyCodeLine{105 \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{keyword}{inline} G4VProcess* GateTotalDiscreteProcess::GetActiveProcess()\textcolor{keyword}{ const}}
\DoxyCodeLine{108 \textcolor{keyword}{}\{}
\DoxyCodeLine{109     \textcolor{keywordflow}{return} m\_oProcessVec[m\_nProcessWithSmallestPIL];}
\DoxyCodeLine{110 \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 \textcolor{keyword}{inline} G4VProcess* GateTotalDiscreteProcess::SampleActiveProcess(G4Material* m,G4double energy)}
\DoxyCodeLine{113 \{}
\DoxyCodeLine{114     G4double tot=m\_pTotalCrossSectionsTable-\/>GetCrossSection(m,energy);}
\DoxyCodeLine{115     \textcolor{keywordtype}{size\_t} i=m\_nNumProcesses;}
\DoxyCodeLine{116     G4double rand=G4UniformRand()*tot;}
\DoxyCodeLine{117     G4double p=m\_oCrossSectionsTableVec[-\/-\/i]-\/>GetCrossSection(m,energy);}
\DoxyCodeLine{118     \textcolor{keywordflow}{while} (rand>p)}
\DoxyCodeLine{119     \{ p+=m\_oCrossSectionsTableVec[-\/-\/i]-\/>GetCrossSection(m,energy);\};}
\DoxyCodeLine{120     m\_nProcessWithSmallestPIL=i;}
\DoxyCodeLine{121     \textcolor{keywordflow}{return} m\_oProcessVec[i];}
\DoxyCodeLine{122 \}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 }
\DoxyCodeLine{125 }
\DoxyCodeLine{126 }
\DoxyCodeLine{127 }
\DoxyCodeLine{128 }
\DoxyCodeLine{129 }
\DoxyCodeLine{130 }
\DoxyCodeLine{131 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
