\hypertarget{GateFictitiousFastSimulationModel_8hh_source}{}\doxysection{Gate\+Fictitious\+Fast\+Simulation\+Model.\+hh}
\label{GateFictitiousFastSimulationModel_8hh_source}\index{/biomaps/physique/appli/GateOlga/src/source/physics/include/GateFictitiousFastSimulationModel.hh@{/biomaps/physique/appli/GateOlga/src/source/physics/include/GateFictitiousFastSimulationModel.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2 \textcolor{comment}{   Copyright (C): OpenGATE Collaboration}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{This software is distributed under the terms}}
\DoxyCodeLine{5 \textcolor{comment}{of the GNU Lesser General  Public Licence (LGPL)}}
\DoxyCodeLine{6 \textcolor{comment}{See LICENSE.md for further details}}
\DoxyCodeLine{7 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#ifndef GateFictitiousFastSimulationModel\_hh}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#define GateFictitiousFastSimulationModel\_hh 1}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <G4VFastSimulationModel.hh>}}
\DoxyCodeLine{13 }
\DoxyCodeLine{18 \textcolor{keyword}{class }\mbox{\hyperlink{classGateFictitiousVoxelMap}{GateFictitiousVoxelMap}};}
\DoxyCodeLine{19 \textcolor{keyword}{class }\mbox{\hyperlink{classGateCrossSectionsTable}{GateCrossSectionsTable}};}
\DoxyCodeLine{20 \textcolor{keyword}{class }\mbox{\hyperlink{classGateTotalDiscreteProcess}{GateTotalDiscreteProcess}};}
\DoxyCodeLine{21 \textcolor{keyword}{class }G4Material;}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}G4ios.hh"{}}}
\DoxyCodeLine{23 \textcolor{keyword}{class }G4VSolid;}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}GatePETVRTSettings.hh"{}}}
\DoxyCodeLine{25 \textcolor{keyword}{class }G4StepPoint;}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}G4ThreeVector.hh"{}}}
\DoxyCodeLine{27 \textcolor{keyword}{class }\mbox{\hyperlink{classGatePhantomSD}{GatePhantomSD}};}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}G4Track.hh"{}}}
\DoxyCodeLine{29 \textcolor{keyword}{class }G4Step;}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include "{}G4TrackFastVector.hh"{}}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{class }\mbox{\hyperlink{classGateFictitiousFastSimulationModel}{GateFictitiousFastSimulationModel}} : \textcolor{keyword}{public} G4VFastSimulationModel}
\DoxyCodeLine{34 \{}
\DoxyCodeLine{35     \textcolor{keyword}{public}:}
\DoxyCodeLine{36     }
\DoxyCodeLine{37         \mbox{\hyperlink{classGateFictitiousFastSimulationModel}{GateFictitiousFastSimulationModel}} ( G4double absoluteMinEnergy, G4double absoluteMaxEnergy );}
\DoxyCodeLine{38         \mbox{\hyperlink{classGateFictitiousFastSimulationModel}{\string~GateFictitiousFastSimulationModel}}();}
\DoxyCodeLine{39 }
\DoxyCodeLine{40         \textcolor{keywordtype}{bool} SetParameters(\textcolor{keyword}{const} \mbox{\hyperlink{classGatePETVRTSettings}{GatePETVRTSettings}}* settings); \textcolor{comment}{// returns true if everything initialized}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42         \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} Initialized() \textcolor{keyword}{const};}
\DoxyCodeLine{43 }
\DoxyCodeLine{44         \textcolor{keywordtype}{void} SetMinEnergy(G4double);}
\DoxyCodeLine{45         \textcolor{keywordtype}{void} SetMaxEnergy(G4double);}
\DoxyCodeLine{46 }
\DoxyCodeLine{47         \textcolor{keywordtype}{void} AttachPhantomSD(\mbox{\hyperlink{classGatePhantomSD}{GatePhantomSD}}*);}
\DoxyCodeLine{48         G4bool IsApplicable ( \textcolor{keyword}{const} G4ParticleDefinition\& );}
\DoxyCodeLine{49         G4bool ModelTrigger ( \textcolor{keyword}{const} G4FastTrack \& );}
\DoxyCodeLine{50         \textcolor{keywordtype}{void} DoIt ( \textcolor{keyword}{const} G4FastTrack\&, G4FastStep\& );}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{keyword}{private}:}
\DoxyCodeLine{53         \textcolor{keywordtype}{void} SetTotalDiscreteProcess ( \mbox{\hyperlink{classGateTotalDiscreteProcess}{GateTotalDiscreteProcess}}* );}
\DoxyCodeLine{54         \textcolor{keywordtype}{void} SetFictitiousMap ( \mbox{\hyperlink{classGateVFictitiousMap}{GateVFictitiousMap}}* );}
\DoxyCodeLine{55         \textcolor{keyword}{inline} \textcolor{keywordtype}{void} SetApproximations ( GatePETVRT::Approx );}
\DoxyCodeLine{56         \textcolor{keywordtype}{void} StepwiseTrace();}
\DoxyCodeLine{57         \textcolor{keywordtype}{void} VolumeTrace();}
\DoxyCodeLine{58         \textcolor{keyword}{inline} \textcolor{keywordtype}{void} Affine ( G4ThreeVector\& current, \textcolor{keyword}{const} G4ThreeVector\& dir, \textcolor{keyword}{const} G4double length) \textcolor{keyword}{const};}
\DoxyCodeLine{59         \textcolor{comment}{//void SetCrossSectionsTable ( const GateCrossSectionsTable* );}}
\DoxyCodeLine{60         \textcolor{keyword}{inline} \textcolor{keywordtype}{void} AddSecondaries(G4VParticleChange* change);}
\DoxyCodeLine{61         \textcolor{keyword}{inline} \textcolor{keywordtype}{void} AddSecondariesToFastStep();}
\DoxyCodeLine{62         \textcolor{keyword}{inline} \textcolor{keywordtype}{void} DiscardPhoton();}
\DoxyCodeLine{63         \textcolor{keyword}{const} \mbox{\hyperlink{classGateCrossSectionsTable}{GateCrossSectionsTable}}* pTotalCrossSectionsTable;}
\DoxyCodeLine{64         \mbox{\hyperlink{classGateVFictitiousMap}{GateVFictitiousMap}}* pFictitiousMap;}
\DoxyCodeLine{65         \mbox{\hyperlink{classGateTotalDiscreteProcess}{GateTotalDiscreteProcess}}* pTotalDiscreteProcess;}
\DoxyCodeLine{66         \textcolor{comment}{//const G4Material* pMaxMaterial;}}
\DoxyCodeLine{67         \textcolor{keyword}{const} G4VSolid* pEnvelopeSolid;}
\DoxyCodeLine{68         G4double m\_nMinEnergy, m\_nMaxEnergy;}
\DoxyCodeLine{69         G4double m\_nDiscardEnergy;}
\DoxyCodeLine{70         GatePETVRT::Approx m\_nApproximations;}
\DoxyCodeLine{71         \textcolor{keywordtype}{bool} m\_nInitialized,m\_Initialized2nd;}
\DoxyCodeLine{72         \textcolor{keyword}{const} G4FastTrack* pCurrentFastTrack;}
\DoxyCodeLine{73         G4Track* pCurrentTrack;}
\DoxyCodeLine{74         G4Step* pCurrentTrackStep;}
\DoxyCodeLine{75         G4FastStep* pCurrentFastStep;}
\DoxyCodeLine{76         G4double m\_nCurrentInvFictCrossSection;}
\DoxyCodeLine{77         G4double m\_nCurrentEnergy;}
\DoxyCodeLine{78         G4double m\_nPathLength;}
\DoxyCodeLine{79         G4double m\_nTotalPathLength;}
\DoxyCodeLine{80         G4double m\_nDistToOut;}
\DoxyCodeLine{81         G4double m\_nTime;}
\DoxyCodeLine{82         G4double m\_nCurrentVelocity;}
\DoxyCodeLine{83         G4ThreeVector m\_nCurrentLocalPosition;}
\DoxyCodeLine{84         G4ThreeVector m\_nCurrentLocalDirection;}
\DoxyCodeLine{85         \mbox{\hyperlink{classGatePhantomSD}{GatePhantomSD}}* pPhantomSD;}
\DoxyCodeLine{86         G4TrackFastVector* m\_pTrackFastVector;}
\DoxyCodeLine{87         G4int m\_nNumSecondaries;}
\DoxyCodeLine{88         G4double m\_nSurfaceTolerance;}
\DoxyCodeLine{89         \textcolor{keyword}{const} G4AffineTransform* pInverseTransform;}
\DoxyCodeLine{90         \textcolor{keyword}{const} G4AffineTransform* pTransform;}
\DoxyCodeLine{91         G4double m\_nAbsMinEnergy;}
\DoxyCodeLine{92         G4double m\_nAbsMaxEnergy;}
\DoxyCodeLine{93 \}}
\DoxyCodeLine{94 ;}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} GateFictitiousFastSimulationModel::Initialized()\textcolor{keyword}{ const}}
\DoxyCodeLine{97 \textcolor{keyword}{}\{}
\DoxyCodeLine{98     \textcolor{keywordflow}{return} m\_nInitialized;}
\DoxyCodeLine{99 \}}
\DoxyCodeLine{100 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} GateFictitiousFastSimulationModel::SetApproximations ( GatePETVRT::Approx b )}
\DoxyCodeLine{101 \{}
\DoxyCodeLine{102     m\_nApproximations=b;}
\DoxyCodeLine{103 \}}
\DoxyCodeLine{104 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} GateFictitiousFastSimulationModel::Affine ( G4ThreeVector\& current, \textcolor{keyword}{const} G4ThreeVector\& dir, \textcolor{keyword}{const} G4double length)\textcolor{keyword}{ const}}
\DoxyCodeLine{105 \textcolor{keyword}{}\{}
\DoxyCodeLine{106         current[0]+=dir[0]*length;}
\DoxyCodeLine{107         current[1]+=dir[1]*length;}
\DoxyCodeLine{108         current[2]+=dir[2]*length;}
\DoxyCodeLine{109 \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} GateFictitiousFastSimulationModel::AddSecondaries(G4VParticleChange* change)}
\DoxyCodeLine{112 \{}
\DoxyCodeLine{113     G4int numSec=change-\/>GetNumberOfSecondaries();}
\DoxyCodeLine{114     G4int numTotal=numSec+m\_nNumSecondaries;}
\DoxyCodeLine{115     \textcolor{keywordflow}{if} (numTotal>=G4TrackFastVectorSize)}
\DoxyCodeLine{116                 G4Exception ( \textcolor{stringliteral}{"{}GateFictitiousFastSimulationModel::AddSecondaries(G4VParticleChange* change) const"{}}, \textcolor{stringliteral}{"{}Too many secondaries (>512)!"{}}, FatalException,}
\DoxyCodeLine{117                           \textcolor{stringliteral}{"{}Not foreseen."{}} );}
\DoxyCodeLine{118 }
\DoxyCodeLine{119     pCurrentFastStep-\/>SetNumberOfSecondaryTracks ( numSec );}
\DoxyCodeLine{120     \textcolor{keywordflow}{for} ( G4int i=0;i<numSec;i++ )}
\DoxyCodeLine{121     \{}
\DoxyCodeLine{122         change-\/>GetSecondary ( i )-\/>SetGlobalTime ( m\_nTime );}
\DoxyCodeLine{123         m\_pTrackFastVector-\/>SetElement(i+m\_nNumSecondaries, (change-\/>GetSecondary ( i )));}
\DoxyCodeLine{124     \}}
\DoxyCodeLine{125     m\_nNumSecondaries=numTotal;}
\DoxyCodeLine{126     change-\/>Clear();}
\DoxyCodeLine{127 \}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} GateFictitiousFastSimulationModel::AddSecondariesToFastStep()}
\DoxyCodeLine{130 \{}
\DoxyCodeLine{131         pCurrentFastStep-\/>SetNumberOfSecondaries(m\_nNumSecondaries);}
\DoxyCodeLine{132         \textcolor{keywordflow}{for} ( G4int i=0;i<m\_nNumSecondaries;i++ )}
\DoxyCodeLine{133             pCurrentFastStep-\/>AddSecondary((*m\_pTrackFastVector)[i]);}
\DoxyCodeLine{134 \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} GateFictitiousFastSimulationModel::DiscardPhoton()}
\DoxyCodeLine{137 \{}
\DoxyCodeLine{138                 pCurrentFastStep-\/>KillPrimaryTrack();}
\DoxyCodeLine{139                 pCurrentFastStep-\/>ProposePrimaryTrackPathLength(0.0);}
\DoxyCodeLine{140                 pCurrentFastStep-\/>ProposeTotalEnergyDeposited(m\_nCurrentEnergy);}
\DoxyCodeLine{141 \}}
\DoxyCodeLine{142 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{143 }

\end{DoxyCode}
